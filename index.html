<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NOCIV.CO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: black;
  color: #ccc;
  font-family: Arial, Helvetica, sans-serif;
  text-align: center;
}

a {
  color: #ccc;
  text-decoration: none;
}

header img {
  width: 100%;
  max-width: 700px;
  margin-top: 40px;
  margin-bottom: 40px;
}

/* --- RESTORED MANIFESTO STYLES --- */
.manifesto {
  font-size: 1.2rem;
  line-height: 2.2;
  margin-bottom: 60px;
  max-width: 700px;
  margin-left: auto;
  margin-right: auto;
  padding: 0 20px;
}

#states button {
  margin: 4px;
  background: #111;
  color: #aaa;
  border: 1px solid #333;
  padding: 6px 12px;
  cursor: pointer;
}
#states button:hover {
  background: #333;
}

#editor {
  display: none;
  margin-top: 40px;
}

textarea {
  width: 100%;
  padding: 12px;
  background: #111;
  border: 1px solid #333;
  color: #ccc;
  resize: none;
  font-size: 16px;
}

#sendBtn {
  margin-top: 20px;
  padding: 10px 20px;
  cursor: pointer;
  background: #111;
  border: 1px solid #444;
  color: #ccc;
}
#sendBtn:hover {
  background: #333;
}

.postWrap {
  border-top: 1px solid #222;
  padding: 16px 0;
  text-align: left;
}
.postDate {
  float: right;
  opacity: .6;
  font-size: 12px;
}
.postText {
  white-space: pre-wrap;
  margin-top: 10px;
}

.greenMark {
  color: #0b3d2e;
}

.clearfix {
  clear: both;
}
</style>
</head>

<body>

<header>
  <img src="headergreynociv.svg" alt="NOCIV">
</header>

<p class="manifesto">
Representing Black America.<br><br>
Showcasing present connection.<br><br>
No ads. No algorithm. Just human.
</p>

<hr style="border-color:#222; margin:30px 0;">

<div style="max-width:900px; margin:60px auto 40px auto; padding: 0 20px;">
  <img src="black-america.svg" style="width:100%;" alt="Black America">
</div>

<section style="max-width:900px; margin:auto; padding: 0 20px;">

<h2 style="letter-spacing:4px;">THE STALL WALL</h2>
<p style="opacity:.7; margin-bottom:40px;">
this is how word of mouth works, it goes peer to peer and reaches different states
</p>

<div id="states"></div>

<div id="editor">
  <h2 id="stateTitle"></h2>

  <div style="margin-bottom:20px; text-align:left;">
    <label for="postInput">Speak Your Truth</label>
    <textarea id="postInput" rows="4"></textarea>
  </div>

  <button id="sendBtn">Send Mark</button>

  <div id="postsList" style="margin-top:40px;"></div>
</div>

</section>

<script>
// --- STATE LIST ---
const states = [
  "Alabama","Alaska","Arizona","Arkansas","California","Colorado",
  "Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois",
  "Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland",
  "Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana",
  "Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York",
  "North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania",
  "Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah",
  "Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"
];

const statesDiv = document.getElementById("states");
const editor = document.getElementById("editor");
const stateTitle = document.getElementById("stateTitle");
const postInput = document.getElementById("postInput");
const postsList = document.getElementById("postsList");

let currentState = "";
let secretMode = false;

// render states
states.forEach(st => {
  const btn = document.createElement("button");
  btn.innerText = st;
  btn.onclick = () => {
    currentState = st;
    stateTitle.innerText = st;
    editor.style.display = "block";
    loadPosts();
  };
  statesDiv.appendChild(btn);
});

// secret NOCIV admin mode
window.addEventListener("keydown", e => {
  if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === "n") {
    secretMode = !secretMode;
    alert("âœ¦ NOCIV admin mode " + (secretMode ? "enabled" : "disabled"));
  }
});

// load posts
function loadPosts() {
  postsList.innerHTML = "";
  let allPosts = JSON.parse(localStorage.getItem("stallPosts")) || [];
  let statePosts = allPosts.filter(p => p.state === currentState);

  const now = Date.now();
  statePosts = statePosts.filter(p => now - p.time < 30*24*60*60*1000);
  
  if (statePosts.length === 0) {
    postsList.innerHTML = "<p style='opacity:.6'>No marks yet</p>";
    return;
  }

  statePosts.forEach(p => {
    let div = document.createElement("div");
    div.className = "postWrap";

    let date = document.createElement("div");
    date.className = "postDate";
    date.innerText = p.date;

    let text = document.createElement("div");
    text.className = "postText";
    text.innerText = p.text;

    if (p.admin && secretMode) {
      text.classList.add("greenMark");
    }

    div.appendChild(date);
    div.appendChild(text);

    let clear = document.createElement("div");
    clear.className = "clearfix";
    div.appendChild(clear);

    postsList.appendChild(div);
  });
}

// send mark
document.getElementById("sendBtn").onclick = () => {
  const text = postInput.value.trim();
  if (!text) return;

  const today = new Date();
  const month = today.toLocaleString("en-US", { month: "short" }).toLowerCase();
  const dateStr = month + "." + today.getDate() + "." + today.getFullYear();

  let allPosts = JSON.parse(localStorage.getItem("stallPosts")) || [];

  allPosts.unshift({
    state: currentState,
    text,
    date: dateStr,
    time: Date.now(),
    admin: secretMode
  });

  localStorage.setItem("stallPosts", JSON.stringify(allPosts));
  postInput.value = "";
  loadPosts();
};
</script>

</body>
</html>
